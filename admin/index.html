
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Panel - Praf's Kitchen</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-4">
    <h1 class="mb-4">Admin Dashboard</h1>

    <div class="row mb-4">
      <div class="col-md-6">
        <h5>Daily Orders</h5>
        <canvas id="ordersChart"></canvas>
      </div>
      <div class="col-md-6">
        <h5>Total Sales</h5>
        <p class="fs-4">£1,234.56</p>
      </div>
    </div>

    <div class="mb-4">
      <h5>Order History</h5>
      <div class="row mb-2">
        <div class="col">
          <input type="date" class="form-control" id="fromDate" placeholder="From">
        </div>
        <div class="col">
          <input type="date" class="form-control" id="toDate" placeholder="To">
        </div>
        <div class="col">
          <button class="btn btn-outline-primary w-100" onclick="filterOrders()">Filter</button>
        </div>
        <div class="col">
          <button class="btn btn-outline-success w-100" onclick="exportCSV()">Export CSV</button>
        </div>
      </div>
      <table class="table table-bordered table-sm">
        <thead class="table-light">
          <tr><th>#</th><th>User</th><th>Time Slot</th><th>Date</th><th>Items</th></tr>
        </thead>
        <tbody id="ordersTable"></tbody>
      </table>
    </div>

    <div class="mb-4">
      <h5>Top-Selling Items</h5>
      <table class="table table-striped table-sm">
        <thead class="table-light">
          <tr><th>Item</th><th>Qty Sold</th></tr>
        </thead>
        <tbody id="topItemsTable"></tbody>
      </table>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    const dailyData = [5, 8, 0, 7, 10, 3]; // fake Mon–Sun
    const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

    new Chart(document.getElementById('ordersChart'), {
      type: 'bar',
      data: {
        labels: days,
        datasets: [{
          label: '# of Orders',
          data: dailyData,
          borderWidth: 1
        }]
      }
    });

    const ordersTable = document.getElementById('ordersTable');
    const topItems = {};

    orders.forEach((order, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${index + 1}</td>
        <td>${order.user}</td>
        <td>${order.time}</td>
        <td>${order.date}</td>
        <td>${order.basket.map(i => `${i.name} x${i.qty}`).join(', ')}</td>`;
      ordersTable.appendChild(tr);

      order.basket.forEach(item => {
        if (!topItems[item.name]) topItems[item.name] = 0;
        topItems[item.name] += item.qty;
      });
    });

    const topItemsTable = document.getElementById('topItemsTable');
    for (let name in topItems) {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${name}</td><td>${topItems[name]}</td>`;
      topItemsTable.appendChild(tr);
    }

    function filterOrders() {
      alert("Date filter simulated. Add real logic if needed.");
    }

    function exportCSV() {
      alert("CSV export simulated. Implement real download for production.");
    }
  </script>
</body>
</html>
